<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>D3: A simple, unstyled axis</title>
		<script src="https://d3js.org/d3.v5.min.js"></script>
		<style type="text/css">
			/* No style rules here yet */
		</style>
	</head>
	<body>
		<script type="text/javascript">
			var rowConverter = function(d) {
				return {
					subject: d.subject,
					ac_money: parseFloat(d.ac_money)
				};
			}
			var data;
			var w = 40, //柱宽度
			    height = 500,   //画布高度
			    width = 600,  //画布宽度
			    left = 50,
			    bottom = 20;
			//创建svg画布
			var svg = d3.select('body')
			    .append('svg')
			    .attr('width',width)
			    .attr('height',height)
			    .style('margin-left','100px')
			    .style('padding','20px')
			    .style('border','1px solid green')
			d3.csv("data1.csv", rowConverter, function(d){
				data = d
				
				//绘制数据柱状
				svg.selectAll('rect')
				    .data(data)
				    .enter()
				    .append('rect')
				    .attr('x',function(d,i){
				        return left + w * i
				    })
				    .attr('y',function(d,i){
				        return height - d.ac_money - bottom;
				    })
				    .attr('width',w-5)
				    .attr('height',function(d,i){
				        return d.ac_money
				    })
				    .attr('fill','steelblue')
				//在柱头部标识数据
				svg.selectAll('text')
				    .data(data)
				    .enter()
				    .append('text')
				    .attr('fill','white')
				    .attr('text-anchor','middle')
				    .attr('font-size','12px')
				    .attr('x',function(d,i){
				        return left +  w * i
				    })
				    .attr('y',function(d,i){
				        return height - d.ac_money - bottom;
				    })
				    .attr('dx',function(d,i){
				        return w / 2
				    })
				    .attr('dy','1rem')
				    .text(d.subject)
				//创建线性比例尺
				var x = d3.scaleLinear().domain([0,len]).range([0,480]);
				var y = d3.scaleLinear().domain([0,d3.max(data,function(d) {return d.ac_money;})]).range([600,0]);
				//创建坐标轴
				var axisX = d3.axisBottom().scale(x).ticks(len);
				var axisY = d3.axisLeft().scale(y).ticks(len);
				//绘制坐标轴
				svg.append('g').attr('transform',`translate(${left},${height-bottom})`).call(axisX)
				svg.append('g').attr('transform',`translate(${left},10)`).call(axisY)
			})
		</script>
	</body>
</html>